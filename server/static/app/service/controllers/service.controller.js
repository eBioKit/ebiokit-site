(function(){var app=angular.module("services.controllers.service-list",["ui.bootstrap","ang-dialogs","services.services.service-list"]);app.controller("ServiceListController",function($rootScope,$scope,$http,$uibModal,$dialogs,APP_EVENTS,ServiceList){this.retrieveServicesListData=function(force){$scope.isLoading=true;if(ServiceList.getOld()>1||force){$http($rootScope.getHttpRequestConfig("GET","service-list",{})).then(function successCallback(response){$scope.isLoading=false;$scope.services=ServiceList.setServices(response.data).getServices();$scope.categories=ServiceList.updateCategories().getCategories();if($scope.categories.length>0){$scope.categoryFilter=[$scope.categories[0].name]}},function errorCallback(response){$scope.isLoading=false;debugger;var message="Failed while retrieving the services list.";$dialogs.showErrorDialog(message,{logMessage:message+" at ServiceListController:retrieveServicesListData."});console.error(response.data)})}else{$scope.services=ServiceList.getServices();$scope.isLoading=false}};$scope.filterServices=function(){return function(item){if($scope.searchFor===undefined||$scope.searchFor===""||$scope.searchFor.length<$scope.minSearchLength){return true}return item["title"].toLowerCase().indexOf($scope.searchFor.toLowerCase())!==-1}};$scope.filterServicesByCategory=function(){return function(item){var filterAux,item_categories;return $scope.categoryFilter!==null&&item.enabled&&item["categories"].toLowerCase().indexOf($scope.categoryFilter[0].toLowerCase())!==-1}};this.launchServiceHandler=function(service){$rootScope.$broadcast(APP_EVENTS.launchService,service)};this.launchServiceHandler=function(service){$rootScope.$broadcast(APP_EVENTS.launchService,service)};$scope.getIconText=function(service_name){var text=service_name.split(" ");if(text.length>1){return text[0][0].toUpperCase()+text[1][0].toLowerCase()}return text[0][0].toUpperCase()+text[0][1].toLowerCase()};this.displayHelpHandler=function(service){$scope.displayed_service=service;$scope.displayed_service_categories=service.categories.split(",");debugger;$scope.modalInstance=$uibModal.open({controller:"ServiceListController",controllerAs:"controller",scope:$scope,backdrop:"static",size:"md",template:'<div class="modal-header"><h3 class="modal-title">About {{displayed_service.title}}</h3></div>'+'<div class="modal-body">'+'	<div class="" style="">'+"	   <b>Categories:</b>"+'	   <div class="" style="">'+'	      <span ng-repeat="category in displayed_service_categories" class="label label-primary" style="margin-right: 5px;">{{category}}</span>'+"      </div>"+'	   <p style="margin-top: 10px;"><b>Instance name:</b>{{displayed_service.instance_name}}</p>'+'	   <p style="margin-top: 10px;"><b>Version:</b>{{displayed_service.version}}</p>'+"	   <b>Description:</b>"+'      <p style="margin-top: 10px;min-height:150px; border: 1px solid #dedede;">{{displayed_service.description}}</p>'+"   </div>"+"</div>"+'<div class="modal-footer">'+'	<a class="btn btn-danger" ng-click="controller.closeHelpDialogButtonHandler(\'cancel\')">Close</button>'+"</div>"})};this.closeHelpDialogButtonHandler=function(){$scope.modalInstance.close();delete $scope.modalInstance;delete $scope.displayed_service_categories;delete $scope.displayed_service};var me=this;$scope.services=ServiceList.getServices();$scope.minSearchLength=2;$scope.categories=ServiceList.getCategories();$scope.filters=ServiceList.getFilters();$scope.filteredServices=$scope.services.length;$scope.categoryFilter=[];if($scope.services.length===0){this.retrieveServicesListData(true)}})})();